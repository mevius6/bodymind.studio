extends ./template/_page

block vars
  -
    let page = data.pages.schedule;
  -
    const curr = new Date()
          currentDate  = curr.getDate()
          currentDay   = curr.getDay()
          currentMonth = curr.getMonth()
          currentYear  = curr.getFullYear();
    const startingYear = currentYear;
    const endingYear   = 2020;
    const monthsCount  = 12;
    const daysInWeek   = 7;

    const idPrefix = 'cal_';
    const calName  = 'calendar';
    const dateName = 'calendar_date';
  -
    const daysLabel = [
      'Воскресенье',
      'Понедельник',
      'Вторник',
      'Среда',
      'Четверг',
      'Пятница',
      'Суббота'
    ];
  -
    const daysLabelAbbr = [
      'ВС',
      'ПН',
      'ВТ',
      'СР',
      'ЧТ',
      'ПТ',
      'СБ'
    ];
  -
    const monthsLabel = [
      'Январь',
      'Февраль',
      'Март',
      'Апрель',
      'Май',
      'Июнь',
      'Июль',
      'Август',
      'Сентябрь',
      'Октябрь',
      'Ноябрь',
      'Декабрь'
    ];
  -
    const anchors = [
      {
        'titles': [
          'Gyrotonic'
        ]
      },
      {
        'titles': [
          'Men’s Pilates',
          'Pilates Mat',
          'Pilates Reformer',
          'Power Pilates'
        ]
      },
      {
        'titles': [
          'Fitness Yoga',
          'Fly Yoga',
          'Hatha Yoga',
          'Relax Yoga'
        ]
      },
      {
        'titles': [
          'Full Body',
          'Power Class',
          'Stretching',
          'Super Sculpt',
          'TRX'
        ]
      },
      {
        'titles': [
          'Dance Therapy',
          'Flexibility',
          'Foundation'
        ]
      }
    ];

block content
  include ./calendar

  mixin sessionCard(options)
    .c-session__card
      each anchor, index in anchors
        if anchor.titles.includes(options.title)
          h3.c-session__title: a(href=`/workout#section-id-${index}`)= options.title

      - for (let i = 1; i < daysInWeek; i++)
        - let start = currentDate - currentDay + i
        - let date = new Date(curr.setDate(start))
        - let day = date.getDay()
        if day === options.day
          span.c-session__date=`${daysLabel[options.day]}, ${curr.getDate(date)}`

      span.c-session__coach= options.coach
      span.c-session__cta: a(href="#") Записаться
      if anchors[4].titles.includes(options.title)
        span.c-session__badge дети

  mixin session(options)
    .c-session(
      class={'c-session--merged': options.merge === true}
      style=`--date: var(--day-${options.day}); --time: var(--of-${options.time});`
    )&attributes(attributes)
      if options.merge === true
        +sessionCard({
          day: options.day,
          title: options.title[0],
          coach: options.coach[0]
        })
        +sessionCard({
          day: options.day,
          title: options.title[1],
          coach: options.coach[1]
        })
      else
        +sessionCard({
          day: options.day,
          title: options.title,
          coach: options.coach
        })

  h2.fs-h3.current=`${monthsLabel[currentMonth]} ${currentYear} г.`

  #schedule-heading.visually-hidden
    | Расписание групповых занятий
  .o-schedule(aria-labelledby="schedule-heading")

    //- Актуальные даты
    - for (let i = 1; i < daysInWeek; i++)
      - let start = currentDate - currentDay + i
      - let date = new Date(curr.setDate(start))
      - let day = curr.getDate(date)

      span.date-slot(aria-hidden="true" style=`grid-column: track-${i}; grid-row: tracks;`)
        | #{daysLabel[i]}, #{day}

    h2.time-slot(style="grid-row: time-0900")
      | 09:00
    +session({
      day: 2,
      time: '09',
      title: 'Hatha Yoga',
      coach: 'Елена Лютая'
    })
    +session({
      day: 5,
      time: '09',
      title: 'Hatha Yoga',
      coach: 'Елена Лютая'
    })

    h2.time-slot(style="grid-row: time-1000")
      | 10:00
    +session({
      day: 1,
      time: '10',
      title: 'Power Class',
      coach: 'Анна Сафронова'
    })
    +session({
      day: 2,
      time: '10',
      title: 'Pilates Mat',
      coach: 'Анна Сафронова'
    })
    +session({
      day: 4,
      time: '10',
      title: 'Pilates Mat',
      coach: 'Анна Сафронова'
    })
    +session({
      day: 5,
      time: '10',
      title: 'Power Class',
      coach: 'Анна Сафронова'
    })

    h2.time-slot(style="grid-row: time-1100")
      | 11:00
    +session({
      day: 2,
      time: '11',
      title: 'Full Body',
      coach: 'Анна Сафронова'
    })
    +session({
      day: 4,
      time: '11',
      title: 'Full Body',
      coach: 'Анна Сафронова'
    })
    +session({
      day: 6,
      time: '11',
      title: ['Dance Therapy', 'Hatha Yoga'],
      coach: ['Анна Сафронова', 'Елена Лютая'],
      merge: true
    })

    h2.time-slot(style="grid-row: time-1200")
      | 12:00
    +session({
      day: 6,
      time: '12',
      title: 'Power Pilates',
      coach: 'Анна Сафронова'
    })

    h2.time-slot(style="grid-row: time-1300")
      | 13:00
    +session({
      day: 6,
      time: '13',
      title: ['Relax Yoga', 'Power Class'],
      coach: ['Ольга Лунгу', 'Анна Сафронова'],
      merge: true
    })

    h2.time-slot(style="grid-row: time-1400")
      | 14:00
    //-
      h2.time-slot(style="grid-row: time-1500") 15:00
      h2.time-slot(style="grid-row: time-1600") 16:00
      h2.time-slot(style="grid-row: time-1700") 17:00

    h2.time-slot(style="grid-row: time-1800")
      | 18:00
    +session({
      day: 1,
      time: '18',
      title: 'Dance Therapy',
      coach: 'Анна Сафронова',
    })
    +session({
      day: 2,
      time: '18',
      title: 'Super Sculpt',
      coach: 'Ольга Петухова'
    })
    +session({
      day: 3,
      time: '18',
      title: ['Foundation', 'Flexibility'],
      coach: ['Анастасия Акулова', 'Анна Сафронова'],
      merge: true
    })
    +session({
      day: 4,
      time: '18',
      title: 'Super Sculpt',
      coach: 'Ольга Петухова'
    })
    +session({
      day: 5,
      time: '18',
      title: 'Foundation',
      coach: 'Анастасия Акулова',
    })

    h2.time-slot(style="grid-row: time-1900")
      | 19:00
    +session({
      day: 1,
      time: '19',
      title: 'Power Class',
      coach: 'Анна Сафронова'
    })
    +session({
      day: 2,
      time: '19',
      title: ['Fitness Yoga', 'Power Pilates'],
      coach: ['Ольга Лунгу', 'Татьяна Заднипрянец'],
      merge: true
    })
    +session({
      day: 3,
      time: '19',
      title: ['Stretching', 'Pilates Mat'],
      coach: ['Анастасия Акулова', 'Анна Сафронова'],
      merge: true
    })
    +session({
      day: 4,
      time: '19',
      title: ['Fitness Yoga', 'Power Pilates'],
      coach: ['Ольга Лунгу', 'Татьяна Заднипрянец'],
      merge: true
    })
    +session({
      day: 5,
      time: '19',
      title: ['Stretching', 'Pilates Mat'],
      coach: ['Анастасия Акулова', 'Анна Сафронова'],
      merge: true
    })

    h2.time-slot(style="grid-row: time-2000")
      | 20:00
    +session({
      day: 1,
      time: '20',
      title: ['Hatha Yoga', 'Men’s Pilates'],
      coach: ['Елена Лютая', 'Анна Сафронова'],
      merge: true
    })
    +session({
      day: 2,
      time: '20',
      title: 'Stretching',
      coach: 'Ольга Лунгу'
    })
    +session({
      day: 3,
      time: '20',
      title: ['Hatha Yoga', 'Men’s Pilates'],
      coach: ['Елена Лютая', 'Анна Сафронова'],
      merge: true
    })
    +session({
      day: 4,
      time: '20',
      title: 'Stretching',
      coach: 'Ольга Лунгу'
    })

block scripts
